<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<!-- saved from url=(0065)http://www.canvassoft.somee.com/Products/ViewStitches?idPrdtSim=1 -->
<html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><title>

	ViewStitches

</title><link rel="stylesheet" href="./ViewStitches_files/Site.css"><link rel="stylesheet" href="./ViewStitches_files/Demo.css"><link rel="stylesheet" href="./ViewStitches_files/colorPick.css"><link rel="stylesheet" href="./ViewStitches_files/sbadmin.css"><link rel="stylesheet" href="./ViewStitches_files/bootstrap.min.css"><link rel="stylesheet" href="./ViewStitches_files/font-awesome.min.css">

     <script src="./ViewStitches_files/jquery.min.js"></script>
     <script src="./ViewStitches_files/bootstrap.bundle.min.js"></script>

   <!--  <script src="../jquery.animate-colors.js"></script>-->


     <script src="./ViewStitches_files/accordion.js"></script>

     	<script src="./ViewStitches_files/three.min.js"></script>
        <script src="./ViewStitches_files/OrbitControls.js"></script>
        <script src="./ViewStitches_files/ObjLoader.js"></script>
        <script src="./ViewStitches_files/JSONLoader.js"></script>
        <script src="./ViewStitches_files/Texture.js"></script>
        <script src="./ViewStitches_files/3dMesh.js"></script>

       <script src="./ViewStitches_files/colorPick.js"></script>
       <script src="./ViewStitches_files/DstObj.js"></script>







<style>

    .menuId
    {
      border-color:#ffffff;
      border-width:1px;
      border-style:solid;
      border-bottom-color:#aaaaaa;
    }

.menu
{
    padding: 0 0 0px;
    margin:0px;
    margin-left:300px;
    text-align: left;
    height:50px;
}

.menu li
{
    display: inline;
    float:left;
    padding-top:20px;
    padding-left:30px;
}




.menu li a
{
    font-family: 'Oswald', sans-serif;
    font-size:17px;
    background-color: transparent;
    color: #aaaaaa;
    text-decoration:none;
    padding-left:30px;
    padding-right:30px;
    padding-top:10px;
    padding-bottom:10px;

}

.menu li a:hover
{
    font-family:Arial;
    font-size:17px;
/*    background-color: #0055bb;*/
    //text-decoration:underline;
    color:#0066ff;
}

.CategoryMenu
{
}
.CategoryMenu li
{
    display: block;
    text-align:center;
    width:100px;
}

.CategoryMenu li a
{
    display: block;
    /* all css in one block*/
    width:100px;
    padding-top:10px;
    padding-bottom:10px;
    text-align:center;
    background-color:transparent;
    background-color:Blue;
    color:#ffeeff;
}

.CategoryMenu li a:hover
{
    display: block;
    /* all css in one block*/
    width:100px;
    padding-top:10px;
    padding-bottom:10px;
    text-align:center;
    background-color:Green;
}

.submenu {
  list-style: none;
  padding-left: 40px;
  margin: 0;
  max-height: 250px;
  display: block;
}
/*.nav-submenu:hover .submenu {
  display: block;
  max-height: 250px;
  list-style: none;
}*/


</style>

</head>

<body class="fixed-nav sticky-footer bg-dark" id="page-top">
  <div class="row">
     <div class="col-lg-2">
      <div style="color: White">

      </div>
      <nav class="navbar navbar-expand-lg navbar-dark bg-dark fixed-top" id="mainNav">
        <div class="collapse navbar-collapse">
          <a class="navbar-brand" style="color: white" href="http://www.canvassoft.somee.com/Home/Softwares">
             <img id="Img1" src="./ViewStitches_files/Logo.png">
              Ai2Emb2Plt
             </a>

               <ul class="navbar-nav navbar-sidenav" id="exampleAccordion">
                <li class="nav-item" data-toggle="tooltip" data-placement="right">
                  <a class="nav-link" href="http://www.canvassoft.somee.com/">
                        <span class="nav-link-text">
                            Начало
                        </span> </a>
                </li>

                <li class="nav-item">
                   <a class="nav-link nav-link-collapse collapsed" data-toggle="collapse" aria-controls="collapse1" href="http://www.canvassoft.somee.com/Products/ViewStitches?idPrdtSim=1#collapse1" data-parent="#exampleAccordion">
                    <span class="nav-link-text">Продукти</span>
                    </a>

                   <ul class="collapse" id="collapse1" style="list-style: none"> <!-- In future i build js onclick and manipulate class dynamicaly-->
                    <li>
                        <a class="nav-link" href="http://www.canvassoft.somee.com/Home/Softwares">
                        <span class="nav-link-text">Ai2Emb2Plt</span></a>
                    </li>
                    <li>
                        <a class="nav-link" href="http://www.canvassoft.somee.com/Home/PhotoPortrait">
                        <span class="nav-link-text">Фото портрет</span></a>
                    </li>

                  </ul>

               </li>

               <!------------------------------------------------------->
               <li class="nav-item">
                   <a class="nav-link nav-link-collapse collapsed" data-toggle="collapse" aria-controls="collapse2" href="http://www.canvassoft.somee.com/Products/ViewStitches?idPrdtSim=1#collapse2" data-parent="#exampleAccordion">
                    <span class="nav-link-text">Галерии</span>
                    </a>

                   <ul class="collapse" id="collapse2" style="list-style: none"> <!-- In future i build js onclick and manipulate class dynamicaly-->
                    <li>
                        <a class="nav-link" href="http://www.canvassoft.somee.com/Products/DesIndex?des_type=Ai">
                        <span class="nav-link-text">Ai2Emb2Plt</span></a>
                    </li>
                    <li>
                        <a class="nav-link" href="http://www.canvassoft.somee.com/Products/DesIndex?des_type=Photo">
                        <span class="nav-link-text">Фото портрет</span></a>
                    </li>

                  </ul>

               </li>

                <li class="nav-item">
                <a class="nav-link" href="http://www.canvassoft.somee.com/Home/Contacts">
                    <span class="nav-link-text">
                        Контакти
                    </span>
                </a>
                </li>
                                        <!--Заглавие,Page,Къде се намира"-->
            </ul>
          </div>
        </nav>
       </div>


  <div class="col-lg-9" style="height: 800px;">


<div id="Resume">

   <div class="row">
	   <div class="col-lg-12" style="height: auto">

	        <div id="Container_3d" style="width:100%x;height:55%;background-color:transparent;margin-left:0px;margin-top:50px;">
	             <p id="Hd1">Бодове на проект за машинна бродерия:Marilyn Monroe
	        		</p>
					</div>

	   </div>
		 	<div class = "col-lg-12" align = "center">
			 <button class="btn btn-primary btn-sm" id="stitches_id" onclick="run_stitches()">Старт</button>
			 <button class="btn btn-success btn-sm" id="Button1" onclick="stop_stitches()">Стоп</button>
			</div>

			<div class= "col-lg-12" align = "center">
		    <img id="loaderid" src="./ViewStitches_files/Loader.gif" style="margin-left: 200px; margin-top: 50px; display: none;"> </img>
		    <canvas id="canvas1" style="margin-top: 10px; width: 600px; height: 600px"> </canvas>
			</div>
   </div>
   </div>

</div>


   <script type="text/javascript">


       var embStitches = [];
       var idEmb = 1


       embTitle = {};
       ax = 0;
       ay = 0;
       prev_ax = ax; prev_ay = ay;
       kx = 0; ky = 0; kz = 0;
       c = null; ctx = null;
       idx = -1;
       interval = 5;
       fl_run = true;

       $(document).ready(function () {
           $.ajax({
               type: "POST",
               url: "/Products/FetchStitches",
               // contentType: "application/json; charset=utf-8",
               data: { idEmb: idEmb }, //!!!!!!!
               dataType: "json",
               success: function (response) {
                   var loaderid = document.getElementById("loaderid")
                   loaderid.style.display = "none";
                   response.forEach(function (emb) {
                       embStitches = response[0];
                       embTitle = response[1];
                       drawEbmStitches();
                       //drawRect();
                       //console.log(emb);
                   });
               },
               failure: function (response) {
                   alert(response.responseText);
               },
               error: function (response) {
                   alert(response.responseText);
               }
           });
       });

    //-----------------------------------
           $(function () {
               $("#fetch_stitches_id").click(function () {
                   $.ajax({
                       type: "POST",
                       url: "/Products/FetchStitches",
                       contentType: "application/json; charset=utf-8",
                       dataType: "json",
                       success: function (response) {
                           response.forEach(function (emb) {
                               embStitches = response[0];
                               embTitle = response[1];
                               drawEbmStitches();
                               //drawRect();
                               //console.log(emb);
                           });
                       },
                       failure: function (response) {
                           alert(response.responseText);
                       },
                       error: function (response) {
                           alert(response.responseText);
                       }
                   });
               });
           });
       function drawRect() {
           c = document.getElementById("canvas1");
           ctx = c.getContext("2d");

           ctx.beginPath();
           ctx.fillStyle = "#fff";
           ctx.fillRect(0, 0, 600, 600);
          /* ctx.lineWidth = "1";
           ctx.strokeStyle = "0aa";
           ctx.rect(10, 10, 590, 590);*/
           ctx.stroke();


       }

       function drawEbmStitches() {
           kx = 400 / embTitle.Sz_x;
           ky = 400 / embTitle.Sz_y;
           kz = kx;
           if (ky < kx) kz = ky;

           c = document.getElementById("canvas1");
           ctx = c.getContext("2d");

           ctx.beginPath();
           ctx.setLineDash([]);
           ctx.fillStyle = "#fff";
           ctx.fillRect(0, 0, 600, 600);
           ctx.lineWidth = "1";
           ctx.strokeStyle = "0aa";
           ctx.rect(0, 0, 600, 600);
           ctx.stroke();

           ax = embTitle.AbsSP.X * kz;
           ay = embTitle.AbsSP.Y * kz;

           ctx.moveTo(100 + ax, 500-ay);
           ctx.stroke();

           embStitches.forEach(function (st) {
               switch (st.cmn) {
                   case 64: break;
                   case 0:
                       {
                          prev_ax = ax; prev_ay = ay;
                          ax += st.rx * kz;
                          ay += st.ry * kz;
                          ctx.beginPath();
                          ctx.setLineDash([]);
                          ctx.moveTo(100 + prev_ax, 500 - prev_ay);
                          ctx.lineTo(100 + ax, 500-ay);
                          ctx.stroke();
                          break;
                      }

                  case 128:
                      {
                          prev_ax = ax; prev_ay = ay;
                          ax += st.rx * kz;
                          ay += st.ry * kz;
                          ctx.beginPath();
                          ctx.setLineDash([2, 15]);
                          ctx.moveTo(100 + prev_ax, 500 - prev_ay);
                          ctx.lineTo(100 + ax, 500-ay);
                          ctx.stroke();
                          break;
                      }

               }
           });
      }

      function slaw_draw_stitches() {
          intervalId =
        setInterval(function () {
            idx++;
            console.log(idx, interval);
            if ((idx >= embStitches.length) || (!fl_run)) {
                clearInterval(intervalId);
                drawEbmStitches();
            }
            else {
                var st = embStitches[idx];
                switch (st.cmn) {
                    case 64: break;
                    case 0:
                        {
                            prev_ax = ax; prev_ay = ay;
                            ax += st.rx * kz;
                            ay += st.ry * kz;
                            ctx.beginPath();
                            ctx.setLineDash([]);
                            ctx.moveTo(100 + prev_ax, 500 - prev_ay);
                            ctx.lineTo(100 + ax, 500 - ay);
                            ctx.stroke();
                            break;
                        }

                    case 128:
                        {
                            prev_ax = ax; prev_ay = ay;
                            ax += st.rx * kz;
                            ay += st.ry * kz;
                            ctx.beginPath();
                            ctx.setLineDash([2, 15]);
                            ctx.moveTo(100 + prev_ax, 500 - prev_ay);
                            ctx.lineTo(100 + ax, 500 - ay);
                            ctx.stroke();
                            break;
                        }

                }
            }
        }, interval)
      }

      function run_stitches() {
          fl_run = true;
          drawRect();
          idx = 0;
          ax = embTitle.AbsSP.X * kz;
          ay = embTitle.AbsSP.Y * kz;
          ctx.moveTo(ax, 600 - ay);
          ctx.stroke();
          slaw_draw_stitches();
      }


      function stop_stitches() {
          fl_run = false;
      }


 </script>


          <div class="col-lg-12" id="footer">
          </div>
  </div>



<!--SCRIPT GENERATED BY SERVER! PLEASE REMOVE-->
<center><a href="http://somee.com/">Web hosting by Somee.com</a></center>

<script language="JavaScript" src="./ViewStitches_files/WholeInsert4.js"></script><div style="height: 65px;">    </div>    <div style="opacity: 0.9; z-index: 2147483647; position: fixed; left: 0px; bottom: 0px; height: 65px; right: 0px; display: block; width: 100%; background-color: #202020; margin: 0px; padding: 0px;">    </div>    <div onmouseover="S_ssac();" onmouseout="D_ssac();" style="position: fixed; z-index: 2147483647; left: 0px; bottom: 0px; height: 65px; right: 0px; display: block; width: 100%; background-color: transparent; margin: 0px; padding: 0px;">        <div style="width: 100%; color: White; font-family: &quot;Helvetica Neue&quot;, &quot;Lucida Grande&quot;, &quot;Segoe UI&quot;, Arial, Helvetica, Verdana, sans-serif; font-size: 11pt;">            <div style="margin-right: auto; margin-left: auto; display: table;  padding:9px; font-size:13pt;">                <a href="http://somee.com/VirtualServer.aspx" style=" text-decoration: none; color:White; margin-right:6px; margin-left:6px;">Hosted Windows Virtual Server. 2.5GHz CPU, 1.5GB RAM, 60GB SSD. Try it now for $1!</a>             </div>            <div style="margin-right: auto; margin-left: auto; display: table; font-size: 9pt; ">                <a href="http://somee.com/" style=" text-decoration: none; color:White; margin-right:6px; margin-left:6px; font-size: 10pt;">Web hosting by Somee.com</a>            </div>        </div>    </div>
<!--SCRIPT GENERATED BY SERVER! PLEASE REMOVE--></body></html>
